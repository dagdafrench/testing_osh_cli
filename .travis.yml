sudo: required
dist: trusty
language: go
## home folder is /home/travis/gopath/src/github.com/radanalyticsio/oshinko-cli
services:
- docker
matrix:
  include:
    - env: TO_TEST=e2e
    - env: TO_TEST=rest
  fast_finish: true

before_install:
## add insecure-registry and restart docker
- pwd
- bash --version
- sudo apt-get install --only-upgrade bash
- bash --version
- sudo cat /etc/default/docker
- sudo service docker stop
- sudo sed -i -e 's/sock/sock --insecure-registry 172.30.0.0\/16/' /etc/default/docker
- sudo cat /etc/default/docker
- sudo service docker start
- sudo service docker status
## chmod needs sudo, so all other commands are with sudo
- sudo mkdir -p /home/travis/gopath/src/github.com/radanalyticsio/oshinko-cli/origin
- sudo chmod -R 766 /home/travis/gopath/src/github.com/radanalyticsio/oshinko-cli/origin


install:
before_script:
script:
- if [ "$TO_TEST" = "e2e" ]; echo "e2e tests" ; fi
- if [ "$TO_TEST" = "rest" ]; echo "Rest tests" ; fi
notifications:
 email:
   on_success: never
   on_failure: never

